<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<script type="text/javascript" src="../jscript/pfcUtils.js"></script>	
	<script type="text/javascript" src="../jscript/TankDesign.js"></script>
	<script type="text/javascript" src='../jscript/pdfmake-master/build/pdfmake.js'></script>
 	<script type="text/javascript" src='../jscript/pdfmake-master/build/vfs_fonts.js'></script>
	<script type="text/javascript" src="../jscript/pdfexport.js"></script>	

	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<link href="../jscript/tooltip.css" rel="stylesheet" type="text/css" />
    <script src="../jscript/tooltip.js" type="text/javascript"></script>
	
	<link href="../jscript/modal.css" rel="stylesheet" type="text/css" />
    <script src="../jscript/modal.js" type="text/javascript"></script>	
	<link href="../css/button.css" rel="stylesheet" type="text/css" />

	<style>
		
input[type=text] {
    width: 80px;
	height:32px; 
	font-size:20px;
	text-align:center; 
}


.myform {
	position:absolute;
	left:0%;
	top:2em;
	padding:10px;
}

.FY3 {        
	/*套管安全距離確認*/
	position:absolute;
	top:170px;
	width:250px;
	height:420px;
	//border: 1px solid;
}

.ANSI_BIL {
	/*沒有使用*/
	width:80px;
	height:40px;
	position:absolute;
	top:30%;
	left:0%;
	//border: 1px solid;

}

.IEC_BIL {                   
	width:80px;
	height:40px;
	position:absolute;
	top:20%;
	left:50%;
	//border: 1px solid;
}
.check_btn1 {
	/*沒有使用*/
	position:absolute;
	bottom:40px;
	left:5%;
	//border: 1px solid;
	text-align:center;
}

.check_btn2 {                  
	position:absolute;
	bottom:40%;
	left:10%;
	//border: 1px solid;
	text-align:center;
}
.ex_btn {                  
	text-align:center;
	width: 160px;
	height: 60px;
	font-size: 20px;
}

.HV_FC {                  
	position:absolute;
	bottom:80%;
	visibility: hidden;
}
	</style>
	
</head>
<script language="JavaScript" type="text/JavaScript">


$(document).ready(function(){
	
    $("#pic1").on("click",function(){
		tooltip.pop(this, '#tip0',{hideDelay:100,calloutPosition: 0.5});
		});
    $("#pic2").on("click",function(){
		tooltip.pop(this, '#tip4',{hideDelay:100,calloutPosition: 0.5});
		});
    $("#pic3").on("click",function(){
		tooltip.pop(this, '#tip8',{hideDelay:100,calloutPosition: 0.5});
		});
    $("#pic4").on("click",function(){
		tooltip.pop(this, '#tip16',{hideDelay:100,calloutPosition: 0.5});
		});
    $("#pic5").on("click",function(){
		tooltip.pop(this, '#tip17',{hideDelay:100,calloutPosition: 0.5});
		});
   $("#pic6").on("click",function(){
		tooltip.pop(this, '#tip18',{hideDelay:100,calloutPosition: 0.5});
		});
	
});	

var SS = 0;
/*BIL標準切換*/
//function Standard_Select(i) {
//
//var ANSI_Impulse_withstand_level = [60,75,95,125,200,250,300,450,550,650,750,825,975]; 
//var IEC_Impulse_withstand_level  = [60,75,95,110,150,200,250,350,450,550,650,750,850,950,1050,1175]; 
//var FE_Impulse_withstand_level = [60,75,95,110,125,150,200,250,300,350,450,550,650,750,850,900,950,975,1050];
//SS = i;
//switch (i) {
//        case 0:    //None
//			//document.getElementById("IEC_BIL").style.display = "none";
//			//document.getElementById("ANSI_BIL").style.display = "none";
//			//document.getElementById("check_btn1").style.display = "none";
//			//document.getElementById("check_btn2").style.display = "none";
//			for (j = 0 ; j < 16 ; j++)
//				{		
//				document.getElementById("IEC_BIL").options.remove(0);   
//				}
//				var op = document.createElement("option");
//				op.text = "None";
//				document.getElementById("IEC_BIL").options.add(op);
//				
//            break;
//        case 1:    //IEC
//			//document.getElementById("IEC_BIL").style.display = "none";
//			//document.getElementById("check_btn2").style.display = "none";
//			//document.getElementById("ANSI_BIL").style.display = "block";
//			//document.getElementById("check_btn1").style.display = "block";
//			
//			var L = document.getElementById("IEC_BIL").options.length;   //取得目前select option 長度
//			
//			for (j = 0 ; j < L ; j++)									 //移除全部選項
//				{		
//				document.getElementById("IEC_BIL").options.remove(0);   
//				}
//			for (j = 0 ; j < IEC_Impulse_withstand_level.length ; j++)  //替換成IEC標準
//				{
//				var op = document.createElement("option");
//				op.text = IEC_Impulse_withstand_level[j]+"kV";
//				document.getElementById("IEC_BIL").options.add(op,j);
//				}
//            break;
//			
//        case 2:   //ANSI
//			//document.getElementById("ANSI_BIL").style.display = "none";
//			//document.getElementById("check_btn1").style.display = "none";
//			//document.getElementById("IEC_BIL").style.display = "block";
//			//document.getElementById("check_btn2").style.display = "block";
//			
//			var L = document.getElementById("IEC_BIL").options.length;
//			
//			for (j = 0 ; j < L ; j++)
//				{
//				document.getElementById("IEC_BIL").options.remove(0);   
//				}
//	
//			for (j = 0 ; j < ANSI_Impulse_withstand_level.length ; j++)
//				{
//				var op = document.createElement("option");
//				op.text = ANSI_Impulse_withstand_level[j]+"kV";
//				document.getElementById("IEC_BIL").options.add(op,j);
//				}
//            break;
//			
//		 case 3: //FE
//			var L = document.getElementById("IEC_BIL").options.length;
//			
//			for (j = 0 ; j < L ; j++)
//				{
//				document.getElementById("IEC_BIL").options.remove(0);   
//				}
//	
//			for (j = 0 ; j < FE_Impulse_withstand_level.length ; j++)
//				{
//				var op = document.createElement("option");
//				op.text = FE_Impulse_withstand_level[j]+"kV";
//				document.getElementById("IEC_BIL").options.add(op,j);
//				}
//			HVD_BIL_check(0);
//            break;
//			}
//
//
//}
function Standard_Select(i) {

var ANSI_Impulse_withstand_level = [60,75,95,125,200,250,300,450,550,650,750,825,975]; 
var IEC_Impulse_withstand_level  = [60,75,95,110,150,200,250,350,450,550,650,750,850,950,1050,1175]; 
var FE_Impulse_withstand_level = [60,75,95,110,125,150,200,250,300,350,450,550,650,750,825,850,900,950,975,1050];
SS = i;
switch (i) {
        case 0:    //None
			//document.getElementById("IEC_BIL").style.display = "none";
			//document.getElementById("ANSI_BIL").style.display = "none";
			//document.getElementById("check_btn1").style.display = "none";
			//document.getElementById("check_btn2").style.display = "none";
			for (j = 0 ; j < 16 ; j++)
				{		
				document.getElementById("IEC_BIL").options.remove(0);   
				}
				var op = document.createElement("option");
				op.text = "None";
				document.getElementById("IEC_BIL").options.add(op);
				
            break;
			
		 case 1: //FE
			var L = document.getElementById("IEC_BIL").options.length;
			
			for (j = 0 ; j < L ; j++)
				{
				document.getElementById("IEC_BIL").options.remove(0);   
				}
	
			for (j = 0 ; j < FE_Impulse_withstand_level.length ; j++)
				{
				var op = document.createElement("option");
				op.text = FE_Impulse_withstand_level[j]+"kV";
				document.getElementById("IEC_BIL").options.add(op,j);
				}
			HVD_BIL_check(0);
            break;
			}


}

function myFunction(i) {
/*ANSI BIL標準*/
var ANSI_Impulse_withstand_level = [60,75,95,125,200,250,300,450,550,650,750,825,975];
var ANSI_Clearance_distance_to_ground = [89,114,152,203,305,381,584,762,940,1118,1321,1600,1930];
var ANSI_Clearance_distance_to_phase = [102,127,165,229,330,432,635,838,1041,1245,1448,1778,2134];


/*IEC BIL標準*/
var IEC_Impulse_withstand_level = [60,75,95,110,150,200,250,350,450,550,650,750,850,950,1050,1175];
var IEC_Clearance_distance_to_ground = [65,100,140,165,225,330,450,630,830,1050,1250,1450,1500,1900,2300,2700];
var IEC_Clearance_distance_to_phase = [65,100,140,165,225,330,450,630,830,1050,1250,1450,1800,2250,2650,3100];

/*公稱直徑*/
var HV_FC_1 = [400,500,600];
var HV_FC = document.getElementById("HV_FC_1").value;
var HV_FLANGE_1_X = document.getElementById("HV_FLANGE_1_X").value;
var BCT_D = document.getElementById("BCT_D").value;

/*油中電界標準*/
var Clearance_distance_to_oil = [80,155,180];



var temp = 0;
var oil = 0;
switch (SS) {
		case 0:
			alert("請先選擇安全標準");
		break;
		
		case 1:  /*IEC*/
			if(BCT_D=="" || BCT_D < 0 || isNaN(BCT_D)){alert("請輸入BCT外徑");}
			else{
			/*HV套管間距判斷*/
			if(HV_FLANGE_1_X  < IEC_Clearance_distance_to_phase[i] ){temp = temp + 1;}
			/*公稱直徑對地距離判斷*/
			if(IEC_Impulse_withstand_level[i] < 200){oil = 0;}
			if(IEC_Impulse_withstand_level[i] >= 200 && IEC_Impulse_withstand_level[i] < 400){oil = 1;}
			if(IEC_Impulse_withstand_level[i] >= 400){oil = 2;}
			if(HV_FC_1[HV_FC-1] < Clearance_distance_to_oil[oil]*2){temp = temp + 3;}  //目前沒有器具，先以套管箱中心
			//if(HV_FC_1[HV_FC-1] < IEC_Clearance_distance_to_ground[i]){temp = temp + 3;}
			/*公稱直徑與BCT外徑判斷*/
			if(HV_FC_1[HV_FC-1] < BCT_D){temp = temp + 5;}
			switch (temp) {
					case 0 :  /*皆符合*/
						document.getElementById("HV_FC_1").style.color = "black";
						document.getElementById("HV_FLANGE_1_X").style.color = "black";
						document.getElementById("BCT_D").style.color = "black";
						alert("符合IEC規範\n"+"HV套管間距 = "+HV_FLANGE_1_X+" mm\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm\n"+"BCT外徑 = "+BCT_D+" mm");
						break;
					case 1 :  /*HV套管間距不符合*/
						document.getElementById("HV_FLANGE_1_X").style.color = "red";
						document.getElementById("HV_FC_1").style.color = "black";
						document.getElementById("BCT_D").style.color = "black";
						alert("HV套管間距不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，相間距離不足，請修改「HV套管間距」，相間距離至少大於"+IEC_Clearance_distance_to_phase[i]+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"HV套管間距 = "+document.getElementById("HV_FLANGE_1_DIS").value+"mm，相間距離不足\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 3 :  /*公稱直徑對地距離不符合*/
						document.getElementById("HV_FC_1").style.color = "red";
						document.getElementById("HV_FLANGE_1_X").style.color = "black";
						document.getElementById("BCT_D").style.color = "black";
						alert("公稱直徑不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，對地距離不足，請修改「公稱直徑」，直徑至少大於"+IEC_Clearance_distance_to_ground[i]+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"公稱直徑 = "+HV_FC_1[HV_FC-1]+"mm，對地距離不足\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 5 :  /*公稱直徑與BCT外徑不符合*/
						document.getElementById("HV_FC_1").style.color = "black";
					    document.getElementById("HV_FLANGE_1_X").style.color = "black";
						document.getElementById("BCT_D").style.color = "red";
						alert("公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm，請檢查BCT外徑或修改「公稱直徑」，直徑至少大於"+BCT_D+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 1+3 :  /*HV套管間距與對地距離不符合*/
						document.getElementById("HV_FLANGE_1_X").style.color = "red";
						document.getElementById("HV_FC_1").style.color = "red";
						document.getElementById("BCT_D").style.color = "black";
						alert("HV套管間距不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，相間距離不足，請修改「HV套管間距」，相間距離至少大於"+IEC_Clearance_distance_to_phase[i]+" mm\n\n公稱直徑不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，對地距離不足，請修改「公稱直徑」，直徑至少大於"+IEC_Clearance_distance_to_ground[i]+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"HV套管間距 = "+document.getElementById("HV_FLANGE_1_DIS").value+"mm，相間距離不足\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+"mm，對地距離不足\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 1+5 :  /*HV套管間距與BCT外徑不符合*/
						document.getElementById("HV_FC_1").style.color = "black";
						document.getElementById("HV_FLANGE_1_X").style.color = "red";
						document.getElementById("BCT_D").style.color = "red";
						alert("HV套管間距不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，相間距離不足，請修改「HV套管間距」，相間距離至少大於"+IEC_Clearance_distance_to_phase[i]+" mm\n\n公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm，請檢查BCT外徑或修改「公稱直徑」，直徑至少大於"+BCT_D+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"HV套管間距 = "+document.getElementById("HV_FLANGE_1_DIS").value+"mm，相間距離不足\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm\n========================================";						
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 3+5 : /*公稱直徑對地距離與BCT外徑不符合*/
						document.getElementById("HV_FLANGE_1_X").style.color = "black";
						document.getElementById("HV_FC_1").style.color = "red";
						document.getElementById("BCT_D").style.color = "red";
						alert("公稱直徑不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，對地距離不足，請修改「公稱直徑」，直徑至少大於"+IEC_Clearance_distance_to_ground[i]+" mm\n\n公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm，請檢查BCT外徑或修改「公稱直徑」，直徑至少大於"+BCT_D+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"公稱直徑 = "+HV_FC_1[HV_FC-1]+"mm，對地距離不足\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 1+3+5 : /*皆不符合*/
						document.getElementById("HV_FLANGE_1_X").style.color = "red";
						document.getElementById("HV_FC_1").style.color = "red";
						document.getElementById("BCT_D").style.color = "red";
						alert("HV套管間距不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，相間距離不足，請修改「HV套管間距」，相間距離至少大於"+IEC_Clearance_distance_to_phase[i]+" mm\n\n公稱直徑不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，對地距離不足，請修改「公稱直徑」，直徑至少大於"+IEC_Clearance_distance_to_ground[i]+" mm\n\n公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm，請檢查BCT外徑或修改「公稱直徑」，直徑至少大於"+BCT_D+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"HV套管間距 = "+document.getElementById("HV_FLANGE_1_DIS").value+"mm，相間距離不足\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+"mm，對地距離不足\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
			}

			/*
			if(HV_FLANGE_1_X  < IEC_Clearance_distance_to_phase[i] ){alert("不符合IEC BIL"+IEC_Impulse_withstand_level[i]+"kV等級規範，請修改「HV套管間距」，相間距離至少大於"+IEC_Clearance_distance_to_phase[i]+"mm");}
			else if(HV_FC_1[HV_FC-1] < IEC_Clearance_distance_to_ground[i]){alert("不符合IEC規範\n"+"公稱直徑 < 對地距離"+IEC_Clearance_distance_to_ground[i]+"mm");}
			else if(HV_FC_1[HV_FC-1] < BCT_D){alert("不符合IEC規範\n"+"公稱直徑 < BCT外徑"+BCT_D+"mm");}
			else{alert("符合IEC規範\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm"+"\nBCT外徑 = "+BCT_D+" mm");}
			*/
			}
		break;
		
		case 2:  /*ANSI*/
			if(BCT_D=="" || BCT_D < 0 || isNaN(BCT_D)){alert("請輸入BCT外徑");}
			else{
			/*HV套管間距判斷*/
			if(HV_FLANGE_1_X  < ANSI_Clearance_distance_to_phase[i] ){temp = temp + 1;}
			/*公稱直徑對地距離判斷*/
			if(ANSI_Impulse_withstand_level[i] < 200){oil = 0;}
			if(ANSI_Impulse_withstand_level[i] >= 200 && ANSI_Impulse_withstand_level[i] < 400){oil = 1;}
			if(ANSI_Impulse_withstand_level[i] >= 400){oil = 2;}
			if(HV_FC_1[HV_FC-1] < Clearance_distance_to_oil[oil]*2){temp = temp + 3;}
			//if(HV_FC_1[HV_FC-1] < ANSI_Clearance_distance_to_ground[i]){temp = temp +3;}
			/*公稱直徑與BCT外徑判斷*/
			if(HV_FC_1[HV_FC-1] < BCT_D){temp = temp +5;}
			switch (temp) {
					case 0 :  /*皆符合*/
						document.getElementById("HV_FC_1").style.color = "black";
						document.getElementById("HV_FLANGE_1_X").style.color = "black";
						document.getElementById("BCT_D").style.color = "black";
						alert("符合ANSI規範\n"+"HV套管間距 = "+HV_FLANGE_1_X+" mm\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm\n"+"BCT外徑 = "+BCT_D+" mm");
						break;
					case 1 :  /*HV套管間距不符合*/
						document.getElementById("HV_FLANGE_1_X").style.color = "red";
						document.getElementById("HV_FC_1").style.color = "black";
						document.getElementById("BCT_D").style.color = "black";
						alert("HV套管間距不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，相間距離不足，請修改「HV套管間距」，相間距離至少大於"+ANSI_Clearance_distance_to_phase[i]+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"HV套管間距 = "+document.getElementById("HV_FLANGE_1_DIS").value+"mm，相間距離不足\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 3 :  /*公稱直徑對地距離不符合*/
						document.getElementById("HV_FC_1").style.color = "red";
						document.getElementById("HV_FLANGE_1_X").style.color = "black";
						document.getElementById("BCT_D").style.color = "black";
						alert("公稱直徑不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，對地距離不足，請修改「公稱直徑」，直徑至少大於"+ANSI_Clearance_distance_to_ground[i]+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"公稱直徑 = "+HV_FC_1[HV_FC-1]+"mm，對地距離不足\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 5 :  /*公稱直徑與BCT外徑不符合*/
						document.getElementById("HV_FC_1").style.color = "black";
					    document.getElementById("HV_FLANGE_1_X").style.color = "black";
						document.getElementById("BCT_D").style.color = "red";
						alert("公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm，請檢查BCT外徑或修改「公稱直徑」，直徑至少大於"+BCT_D+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 1+3 :  /*HV套管間距與對地距離不符合*/
						document.getElementById("HV_FLANGE_1_X").style.color = "red";
						document.getElementById("HV_FC_1").style.color = "red";
						document.getElementById("BCT_D").style.color = "black";
						alert("HV套管間距不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，相間距離不足，請修改「HV套管間距」，相間距離至少大於"+ANSI_Clearance_distance_to_phase[i]+" mm\n\n公稱直徑不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，對地距離不足，請修改「公稱直徑」，直徑至少大於"+ANSI_Clearance_distance_to_ground[i]+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"HV套管間距 = "+document.getElementById("HV_FLANGE_1_DIS").value+"mm，相間距離不足\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+"mm，對地距離不足\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 1+5 :  /*HV套管間距與BCT外徑不符合*/
						document.getElementById("HV_FC_1").style.color = "black";
						document.getElementById("HV_FLANGE_1_X").style.color = "red";
						document.getElementById("BCT_D").style.color = "red";
						alert("HV套管間距不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，相間距離不足，請修改「HV套管間距」，相間距離至少大於"+ANSI_Clearance_distance_to_phase[i]+" mm\n\n公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm，請檢查BCT外徑或修改「公稱直徑」，直徑至少大於"+BCT_D+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"HV套管間距 = "+document.getElementById("HV_FLANGE_1_DIS").value+"mm，相間距離不足\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm\n========================================";						
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 3+5 : /*公稱直徑對地距離與BCT外徑不符合*/
						document.getElementById("HV_FLANGE_1_X").style.color = "black";
						document.getElementById("HV_FC_1").style.color = "red";
						document.getElementById("BCT_D").style.color = "red";
						alert("公稱直徑不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，對地距離不足，請修改「公稱直徑」，直徑至少大於"+ANSI_Clearance_distance_to_ground[i]+" mm\n\n公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm，請檢查BCT外徑或修改「公稱直徑」，直徑至少大於"+BCT_D+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"公稱直徑 = "+HV_FC_1[HV_FC-1]+"mm，對地距離不足\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
					case 1+3+5 : /*皆不符合*/
						document.getElementById("HV_FLANGE_1_X").style.color = "red";
						document.getElementById("HV_FC_1").style.color = "red";
						document.getElementById("BCT_D").style.color = "red";
						alert("HV套管間距不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，相間距離不足，請修改「HV套管間距」，相間距離至少大於"+ANSI_Clearance_distance_to_phase[i]+" mm\n\n公稱直徑不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，對地距離不足，請修改「公稱直徑」，直徑至少大於"+ANSI_Clearance_distance_to_ground[i]+" mm\n\n公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm，請檢查BCT外徑或修改「公稱直徑」，直徑至少大於"+BCT_D+" mm");
						/*暫時輸出錯誤資訊*/
						document.getElementById("data").value = document.getElementById("data").value +"HV套管間距 = "+document.getElementById("HV_FLANGE_1_DIS").value+"mm，相間距離不足\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm < BCT外徑 = "+BCT_D+" mm\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+"mm，對地距離不足\n========================================";
						document.getElementById("data").scrollTop = document.getElementById("data").scrollHeight;  //卷軸顯示最新值 
						break;
			}		
			/*
			if(HV_FLANGE_1_X < ANSI_Clearance_distance_to_phase[i]){alert("不符合ANSI BIL"+ANSI_Impulse_withstand_level[i]+"kV等級規範，請修改「HV套管間距」，相間距離至少大於"+ANSI_Clearance_distance_to_phase[i]+"mm");}
			else if(HV_FC_1[HV_FC-1] < ANSI_Clearance_distance_to_ground[i]){alert("不符合\n"+"公稱直徑 < 對地距離"+ANSI_Clearance_distance_to_ground[i]+"mm");}
			else if(HV_FC_1[HV_FC-1] < BCT_D){alert("不符合\n"+"公稱直徑 < BCT外徑"+BCT_D+"mm");}
			else{alert("符合ANSI規範\n"+"公稱直徑 = "+HV_FC_1[HV_FC-1]+" mm"+"\nBCT外徑 = "+BCT_D+" mm");}
			*/
			}
			break;
			



    
	}



}

/*讀取HV_CAS套管箱開關選項*/
function load_HV_CAS_SW() {

var ItemType = document.pwl.eval("PWL_MODEL");
	if (parseInt(ItemType) === parseInt(document.pwlc.PWL_MODEL)) {
		FeatureID = -1;
	}
var val_ret = document.pwl.pwlParameterValueGet(layoutModelNameExt, parseInt(ItemType),FeatureID, "HV_CAS_SW");
var HV_CAS_SW = val_ret.ParamDoubleVal;

var dd1 = [];

	switch (HV_CAS_SW){
		case 0:
				document.getElementById("HV_CAS_SW").selectedIndex = 0;
				break;
		case 1:
				document.getElementById("HV_CAS_SW").selectedIndex = 1;
				break;
		case 2: 
				document.getElementById("HV_CAS_SW").selectedIndex = 2;
				break;
		case 3: 
				document.getElementById("HV_CAS_SW").selectedIndex = 3;
				break;	
		case 4: 
				document.getElementById("HV_CAS_SW").selectedIndex = 4;
				break;			
		}
dd1.push(document.tankForm.HV_CAS_SW.selectedIndex);		

}	

/*寫入HV_CAS_SW下拉式選單*/            /*若layout值與select option相同Weblink可直接寫入option value值 不用額外撰寫程式*/
function drop(){

var temp = [];
temp.push(document.tankForm.HV_CAS_SW.selectedIndex);

for (var t=0;t < dd1.length;t++)
	{
	dd2[t] = dd1[t];
	dd1[t] = temp[t];
	}


for (var t=0;t < dd1.length;t++)
	{
	if(dd2[t] == dd1[t])
		{
		//alert("參數未變");
		continue;
		}
	else
		{
		switch(t){
			case 0 :
				
				change_HV_CAS_SW(document.tankForm.HV_CAS_SW.selectedIndex);
				break;

			}
				
		}
	}
	
}


function change_HV_CAS_SW(){     
var ItemType = document.pwl.eval("PWL_MODEL");
	if (parseInt(ItemType) === parseInt(document.pwlc.PWL_MODEL)) {
		FeatureID = -1;
	}
	
var ValueType = document.pwl.eval("PWL_VALUE_DOUBLE");
var IntValue;
var StringValue;
var BoolValue;
//Parameter Type: PWL_MODEL, PWL_FEATURE
var ItemType = document.pwl.eval("PWL_MODEL");
var featureID;
if (ItemType === document.pwlc.PWL_MODEL) {
	featureID = -1;
} else {
	//若ItemType是PWL_FEATURE, 則featureID為輸入的【featureID】整數
	//featureID = parseInt(document.set_value.FeatureID.value);
}

	
switch (i) {
        case 0:    //全部關閉
					var ret = document.pwl.pwlParameterValueSet(
					layoutModelNameExt, ItemType, featureID,
					'HV_CAS_SW', ValueType, IntValue,
					0, StringValue, BoolValue);			
				
				break;

        case 1:    //上內
					
					var ret = document.pwl.pwlParameterValueSet(
					layoutModelNameExt, ItemType, featureID,
					'HV_CAS_SW', ValueType, IntValue,
					1, StringValue, BoolValue);		
				break;

		case 2:    //上外

					var ret = document.pwl.pwlParameterValueSet(
					layoutModelNameExt, ItemType, featureID,
					'HV_CAS_SW', ValueType, IntValue,
					2, StringValue, BoolValue);		
				break;

		case 3:    //下內

					var ret = document.pwl.pwlParameterValueSet(
					layoutModelNameExt, ItemType, featureID,
					'HV_CAS_SW', ValueType, IntValue,
					3, StringValue, BoolValue);		
				break;	

		case 4:    //下外

					var ret = document.pwl.pwlParameterValueSet(
					layoutModelNameExt, ItemType, featureID,
					'HV_CAS_SW', ValueType, IntValue,
					4, StringValue, BoolValue);		
				break;				
			}

}

function HVD_BIL_check(i){
//var IEC_Impulse_withstand_level = [60,75,95,110,150,200,250,350,450,550,650,750,850,950,1050,1175];
var IEC_Impulse_withstand_level = [60,75,95,110,125,150,200,250,300,350,450,550,650,750,825,850,900,950,975,1050];



/*根據BIL等級產生下拉式選單-套管箱直徑、BIL、遮蔽球*/	
var HV_FC_D_BIL = ["60kV-無遮蔽球-ΦD400mm",
				   "75kV-無遮蔽球ΦD400mm",
				   "95kV-無遮蔽球ΦD400mm",				   
				   "110kV-無遮蔽球ΦD400mm",
				   "125kV-無遮蔽球ΦD400mm",
				   "150kV-無遮蔽球ΦD400mm",
				   "200kV-無遮蔽球ΦD400mm",
				   "250kV-無遮蔽球ΦD400mm",				   
				   "300kV-無遮蔽球ΦD400mm",				   
				   "350kV-無遮蔽球ΦD400mm",
				   "450kV-有遮蔽球-Φd140mm-ΦD400mm",
				   "450kV-有遮蔽球-Φd170mm-ΦD450mm",
				   "450kV-有遮蔽球-Φd200mm-ΦD450mm",
				   "550kV-有遮蔽球-Φd140mm-ΦD450mm",
				   "550kV-有遮蔽球-Φd170mm-ΦD500mm",
				   "550kV-有遮蔽球-Φd200mm-ΦD500mm",
				   "550kV-有遮蔽球-Φd270mm-ΦD600mm",
				   "650kV-有遮蔽球-Φd170mm-ΦD600mm",
				   "650kV-有遮蔽球-Φd200mm-ΦD600mm",
				   "650kV-有遮蔽球-Φd270mm-ΦD650mm",
				   "750kV-有遮蔽球-Φd170mm-ΦD600mm",
				   "750kV-有遮蔽球-Φd200mm-ΦD650mm",
				   "750kV-有遮蔽球-Φd270mm-ΦD750mm",
				   "825kV-有遮蔽球-Φd200mm-ΦD750mm",
				   "825kV-有遮蔽球-Φd270mm-ΦD850mm",
				   "825kV-有遮蔽球-Φd300mm-ΦD850mm",
				   "850kV-有遮蔽球-Φd200mm-ΦD750mm",
				   "850kV-有遮蔽球-Φd270mm-ΦD850mm",
				   "850kV-有遮蔽球-Φd300mm-ΦD850mm",				   
				   "900kV-有遮蔽球-Φd200mm-ΦD750mm",
				   "900kV-有遮蔽球-Φd270mm-ΦD850mm",
				   "900kV-有遮蔽球-Φd300mm-ΦD850mm",
				   "950kV-有遮蔽球-Φd270mm-ΦD900mm",
				   "950kV-有遮蔽球-Φd300mm-ΦD1000mm",
				   "975kV-有遮蔽球-Φd270mm-ΦD900mm",
				   "975kV-有遮蔽球-Φd300mm-ΦD1000mm",				   
				   "1050kV-有遮蔽球-Φd270mm-ΦD900mm",
				   "1050kV-有遮蔽球-Φd300mm-ΦD1000mm"];
				   
	
var L = document.getElementById("HV_FC_D").options.length;

			
for (j = 0 ; j < L ; j++)
	{
	document.getElementById("HV_FC_D").options.remove(0);   
	}

	if(i<=9){
		for (j = i ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}
	else if(i==10){    //BIL450kV
		for (j = i ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}
	else if(i==11){    //BIL550kV
		for (j = 13 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}	
	else if(i==12){    //BIL650kV
		for (j = 17 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}	
	else if(i==13){    //BIL750kV
		for (j = 20 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}
	else if(i==14){    //BIL825kV
		for (j = 23 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}	
	else if(i==15){    //BIL850kV
		for (j = 26 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}
	else if(i==16){    //BIL900kV
		for (j = 29 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}
	else if(i==17){    //BIL950kV
		for (j = 32 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}	
	else if(i==18){    //BIL975kV
		for (j = 34 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}	
	else if(i==19){    //BIL1050kV
		for (j = 36 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}	
	
BIL_temp = i;
/*套管箱直徑、BIL、遮蔽球*/	
/*
var HV_FC_D_BIL = ["150kV-無遮蔽球-Φd120mm-ΦD400mm",
				   "150kV-無遮蔽球-Φd120mm-ΦD400mm",
				   "150kV-無遮蔽球-Φd120mm-ΦD400mm",
				   "150kV-無遮蔽球-Φd120mm-ΦD400mm",
				   "200kV-無遮蔽球-Φd120mm-ΦD400mm",
				   "350kV-無遮蔽球-Φd120mm-ΦD450mm",
				   "450kV-有遮蔽球-Φd140mm-ΦD400mm",
				   "450kV-有遮蔽球-Φd170mm-ΦD450mm",
				   "450kV-有遮蔽球-Φd200mm-ΦD450mm",
				   "550kV-有遮蔽球-Φd140mm-ΦD450mm",
				   "550kV-有遮蔽球-Φd170mm-ΦD500mm",
				   "550kV-有遮蔽球-Φd200mm-ΦD500mm",
				   "550kV-有遮蔽球-Φd270mm-ΦD600mm",
				   "650kV-有遮蔽球-Φd170mm-ΦD600mm",
				   "650kV-有遮蔽球-Φd200mm-ΦD600mm",
				   "650kV-有遮蔽球-Φd270mm-ΦD650mm",
				   "750kV-有遮蔽球-Φd170mm-ΦD600mm",
				   "750kV-有遮蔽球-Φd200mm-ΦD650mm",
				   "750kV-有遮蔽球-Φd270mm-ΦD750mm",
				   "900kV-有遮蔽球-Φd200mm-ΦD750mm",
				   "900kV-有遮蔽球-Φd270mm-ΦD850mm",
				   "900kV-有遮蔽球-Φd300mm-ΦD850mm",
				   "1050kV-有遮蔽球-Φd270mm-ΦD900mm",
				   "1050kV-有遮蔽球-Φd300mm-ΦD1000mm"];
				   
	
var L = document.getElementById("HV_FC_D").options.length;
			
for (j = 0 ; j < L ; j++)
	{
	document.getElementById("HV_FC_D").options.remove(0);   
	}

	if(i<=4){
		for (j = 0 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}
	else if(i==5){
		for (j = 4 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}
	else if(i==6){
		for (j = 5 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}
	else if(i==7){
		for (j = 5 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}
	else if(i==8){
		for (j = 6 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}	
	else if(i==9){
		for (j = 9 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}	
	else if(i==10){
		for (j = 13 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}		
	else if(i==11){
		for (j = 16 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}
	}		
	else if(i==12){
		for (j = 19 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}	
	}		
	else if(i==13){
		for (j = 22 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}	
	}		
	else if(i==14){
		for (j = 22 ; j < HV_FC_D_BIL.length ; j++){
		var op = document.createElement("option");
		op.text = HV_FC_D_BIL[j];
		document.getElementById("HV_FC_D").options.add(op,j);
		}		
	}
*/


}

var BIL_temp;

function FE_BIL_check (index){
var temp_index = document.getElementById("HV_FC_D").selectedIndex;

var FE_BIL_Standard = [[60,,102,400],
					   [75,,127,400],
					   [95,,165,400],
					   [110,,229,400],
					   [125,,229,400],
					   [150,,330,400],
					   [200,,330,400],
					   [250,,432,400],
					   [300,,635,400],
					   [350,,838,400],
					   [450,140,838,400],
					   [450,170,838,450],
					   [450,200,838,450],
					   [550,140,1041,450],
					   [550,170,1041,500],
					   [550,200,1041,500],
					   [550,270,1041,600],
					   [650,170,1245,600],
					   [650,200,1245,600],
					   [650,270,1245,650],
					   [750,170,1448,600],
					   [750,200,1448,650],
					   [750,270,1448,750],
					   [825,200,1778,750],
					   [825,270,1778,850],
					   [825,300,1778,850],
					   [850,200,2134,750],
					   [850,270,2134,850],
					   [850,300,2134,850],
					   [900,200,2134,750],
					   [900,270,2134,850],
					   [900,300,2134,850],	
					   [950,270,2134,900],
					   [950,300,2134,1000],	
					   [975,270,2134,900],
					   [975,300,2134,1000],	
					   [1050,270,2650,900],			
					   [1050,300,2650,1000]];
			


/*HV套管間距*/
var HV_FLANGE_1_X = document.getElementById("HV_FLANGE_1_X").value;
/*BCT外徑*/
var BCT_D = document.getElementById("BCT_D").value;	
var temp;


///*75、95、110、125、150、200、250、300、350kV*/
//if (BIL_temp <= 9){
//	if(BCT_D < FE_BIL_Standard[BIL_temp + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[BIL_temp + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[temp_index][2]){temp = 4 ;}
//}
///*450kV*/
//if (BIL_temp == 10){
//	if(BCT_D < FE_BIL_Standard[10 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[10 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[10 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[10 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[10 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[10 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[10 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[10 + temp_index][2]){temp = 4 ;}
//}
///*550kV*/
//if (BIL_temp == 11){
//	if(BCT_D < FE_BIL_Standard[13 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[13 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[13 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[13 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[13 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[13 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[13 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[13 + temp_index][2]){temp = 4 ;}
//}
///*650kV*/
//if (BIL_temp == 12){
//	if(BCT_D < FE_BIL_Standard[17 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[17 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[17 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[17 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[17 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[17 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[17 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[17 + temp_index][2]){temp = 4 ;}
//}
///*750kV*/
//if (BIL_temp == 13){
//	if(BCT_D < FE_BIL_Standard[20 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[20 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[20 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[20 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[20 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[20 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[20 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[20 + temp_index][2]){temp = 4 ;}
//}
///*825kV*/
//if (BIL_temp == 14){
//	if(BCT_D < FE_BIL_Standard[23 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[23 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[23 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[23 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[23 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[23 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[23 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[23 + temp_index][2]){temp = 4 ;}
//}
///*850kV*/
//if (BIL_temp == 15){
//	if(BCT_D < FE_BIL_Standard[26 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[26 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[26 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[26 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[26 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[26 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[26 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[26 + temp_index][2]){temp = 4 ;}
//}
///*900kV*/
//if (BIL_temp == 16){
//	if(BCT_D < FE_BIL_Standard[29 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[29 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[29 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[29 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[29 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[29 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[29 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[29 + temp_index][2]){temp = 4 ;}
//}
///*950kV*/
//if (BIL_temp == 17){
//	if(BCT_D < FE_BIL_Standard[32 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[32 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[32 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[32 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[32 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[32 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[32 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[32 + temp_index][2]){temp = 4 ;}
//}
///*975kV*/
//if (BIL_temp == 18){
//	if(BCT_D < FE_BIL_Standard[34 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[34 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[34 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[34 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[34 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[34 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[34 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[34 + temp_index][2]){temp = 4 ;}
//}
///*1050kV*/
//if (BIL_temp == 19){
//	if(BCT_D < FE_BIL_Standard[36 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[36 + temp_index][2]){temp = 1;}
//	else if(BCT_D > FE_BIL_Standard[36 + temp_index][3] && HV_FLANGE_1_X > FE_BIL_Standard[36 + temp_index][2]){temp = 2 ;}
//	else if(BCT_D < FE_BIL_Standard[36 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[36 + temp_index][2]){temp = 3 ;}
//	else if(BCT_D > FE_BIL_Standard[36 + temp_index][3] && HV_FLANGE_1_X < FE_BIL_Standard[36 + temp_index][2]){temp = 4 ;}
//}
//
//switch (temp){
//	case 1:
//		document.getElementById("BCT_D").style.color = "black";
//		document.getElementById("HV_FLANGE_1_X").style.color = "black";
//		alert("OK");
//		break;
//	case 2:
//		document.getElementById("BCT_D").style.color = "red";
//		document.getElementById("HV_FLANGE_1_X").style.color = "black";
//		alert("BCT尺寸不符、請減少BCT外徑或增加套管箱直徑");
//		break;		
//	case 3:
//		document.getElementById("HV_FLANGE_1_X").style.color = "red";
//		document.getElementById("BCT_D").style.color = "black";
//		alert("相間距離不足、請增加套管間距或降低BIL等級");
//		break;
//	case 4:
//		document.getElementById("BCT_D").style.color = "red";
//		document.getElementById("HV_FLANGE_1_X").style.color = "red";
//		alert("BCT尺寸不符、請減少BCT外徑或增加套管箱直徑，且相間距離不足、請增加套管間距或降低BIL等級");
//		break;		
//}

/*75、95、110、125、150、200、250、300、350kV*/
if (BIL_temp <= 9){
	//alert(FE_BIL_Standard[BIL_temp + temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[BIL_temp + temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[temp_index][2]){temp = 2 ;}
}
/*450kV*/
if (BIL_temp == 10){
	//alert(FE_BIL_Standard[10+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[10+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[10 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[10 + temp_index][2]){temp = 2 ;}
}
/*550kV*/
if (BIL_temp == 11){
	//alert(FE_BIL_Standard[13+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[13+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[13 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[13 + temp_index][2]){temp = 2 ;}
}
/*650kV*/
if (BIL_temp == 12){
	//alert(FE_BIL_Standard[17+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[17+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[17 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[17 + temp_index][2]){temp = 2 ;}
}
/*750kV*/
if (BIL_temp == 13){
	//alert(FE_BIL_Standard[20+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[20+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[20 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[20 + temp_index][2]){temp = 2 ;}
}
/*825kV*/
if (BIL_temp == 14){
	alert(FE_BIL_Standard[23+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[23+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[23 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[23 + temp_index][2]){temp = 2 ;}
}
/*850kV*/
if (BIL_temp == 15){
	//alert(FE_BIL_Standard[26+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[26+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[26 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[26 + temp_index][2]){temp = 2 ;}
}
/*900kV*/
if (BIL_temp == 16){
	//alert(FE_BIL_Standard[29+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[29+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[29 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[29 + temp_index][2]){temp = 2 ;}
}
/*950kV*/
if (BIL_temp == 17){
	//alert(FE_BIL_Standard[32+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[32+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[32 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[32 + temp_index][2]){temp = 2 ;}
}
/*975kV*/
if (BIL_temp == 18){
	//alert(FE_BIL_Standard[34+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[34+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[34 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[34 + temp_index][2]){temp = 2 ;}
}
/*1050kV*/
if (BIL_temp == 19){
	//alert(FE_BIL_Standard[36+temp_index][3]);
	document.getElementById("BCT_D").value = FE_BIL_Standard[36+temp_index][3]-80;
	if(HV_FLANGE_1_X > FE_BIL_Standard[36 + temp_index][2]){temp = 1;}
	else if(HV_FLANGE_1_X < FE_BIL_Standard[36 + temp_index][2]){temp = 2 ;}
}

switch (temp){
	case 1:
		document.getElementById("HV_FLANGE_1_X").style.color = "black";
		alert("OK");
		break;
		
	case 2:
		document.getElementById("HV_FLANGE_1_X").style.color = "red";
		alert("相間距離不足、請增加套管間距或降低BIL等級");
		break;	
}



}
/*套管箱直徑下拉式選單改變輸入項值*/
function HV_FC_select(){

var temp_index = document.getElementById("HV_FC_D").selectedIndex;
var BIL_temp = document.getElementById("IEC_BIL").selectedIndex;

var FE_BIL_Standard = [[60,,102,400,1],
					   [75,,127,400,1],
					   [95,,165,400,1],
					   [110,,229,400,1],
					   [125,,229,400,1],
					   [150,,330,400,1],
					   [200,,330,400,1],
					   [250,,432,400,1],
					   [300,,635,400,1],
					   [350,,838,400,1],
					   [450,140,838,400,1],
					   [450,170,838,450,2],
					   [450,200,838,450,2],
					   [550,140,1041,450,2],
					   [550,170,1041,500,3],
					   [550,200,1041,500,3],
					   [550,270,1041,600,4],
					   [650,170,1245,600,4],
					   [650,200,1245,600,4],
					   [650,270,1245,650,5],
					   [750,170,1448,600,4],
					   [750,200,1448,650,5],
					   [750,270,1448,750,6],
					   [825,200,1778,750,6],
					   [825,270,1778,850,7],
					   [825,300,1778,850,7],
					   [850,200,2134,750,6],
					   [850,270,2134,850,7],
					   [850,300,2134,850,7],
					   [900,200,2134,750,6],
					   [900,270,2134,850,7],
					   [900,300,2134,850,7],	
					   [950,270,2134,900,8],
					   [950,300,2134,1000,9],	
					   [975,270,2134,900,8],
					   [975,300,2134,1000,9],	
					   [1050,270,2650,900,8],			
					   [1050,300,2650,1000,9]];

if (BIL_temp <= 9){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[BIL_temp + temp_index][4];
}
/*450kV*/
if (BIL_temp == 10){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[10+temp_index][4];
}
/*550kV*/
if (BIL_temp == 11){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[13+temp_index][4];
}
/*650kV*/
if (BIL_temp == 12){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[17+temp_index][4];
}
/*750kV*/
if (BIL_temp == 13){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[20+temp_index][4];
}
/*825kV*/
if (BIL_temp == 14){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[23+temp_index][4];
}
/*850kV*/
if (BIL_temp == 15){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[26+temp_index][4];
}
/*900kV*/
if (BIL_temp == 16){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[29+temp_index][4];
}
/*950kV*/
if (BIL_temp == 17){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[32+temp_index][4];
}
/*975kV*/
if (BIL_temp == 18){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[34+temp_index][4];
}
/*1050kV*/
if (BIL_temp == 19){
	document.getElementById("HV_FC_1").value = FE_BIL_Standard[36+temp_index][4];
}

}
</script>


<body>
<div class="topbar">
			<ul class="topbar">
			<li ><a href="index.html" target="right"><img src="../img/web.png" width="30px"></a></li>
			<li ><a href="../WebLink使用手冊.pdf" target="right"><strong>WebLink使用說明</strong></a></li>
			<li style="float:right"><a href="mailto:jack.you@fortune.com.tw"><strong>問題回饋</strong></a></li>
			<li style="float:right"><a href="http://www.fortune.com.tw/" target="right"><strong>關於我們</strong></a></li>
			</ul>
</div>
<!-- Trigger/Open The Modal -->
<!-- FY按鈕 -->
<!--<button> 標籤在表格內無法使用modal改成<input type>或其他圖片方式即可，原因不明-->
<!-- The Modal -->
<div id="myModal" class="modal">

<!-- Modal content -->
	<div class="modal-content">
		<div class="modal-header">
			<span class="close" onclick="modal_close()">×</span>
			<h2>歷史異常</h2>
		</div>
		
		<div class="modal-body" id="modal-body">
		</div>
		
		<div class="modal-footer">
		<span class="close-btn" onclick="modal_close()">close</span>
		</div>
	</div>
</div>

<div class="button-group">
<li><div class="button" onclick="TRParametersSave();" style="cursor:pointer;"><a><img src="../img/wrench.png"  align="left" style="height:30px;"/><strong>寫入參數</strong></a></div></li>
<li><div class="button" onclick="rege();" style="cursor:pointer;"><a><img src="../img/circle.png"  align="left" style="height:30px;"/><strong>切換至模型</strong></a></div></li>
<li><div class="button" id="closetip"><a href="#." ><img src="../img/delete.png"  align="left" style="height:30px;"/><strong >關閉提示</strong></a></div></li>
<li><div class="button" id="opentip"><a href="#." ><img src="../img/arrows.png"  align="left" style="height:30px;"/><strong >開啟提示</strong></a></div></li>
</div>



	<form name="tankForm" id="tankFormID" class="myform">
           	<table width="900" border="0" cellspacing="0" cellpadding="0">
                <tr>
				<td>
				<table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
				<td colspan="2" align="right" valign="middle" style="font-size:40px"><p><i> <marquee> <font face="monospace font" color="gray">變壓器上蓋設計</font></marquee></i></p></td>
				</tr>
				</table>
			
				<div style="display:none;">
						<div id="tip0">
							<img src="../pic/HVPTUPE.PNG" style="float:right;width:900px;height:400px;" alt="" />
							<h1 align="center">HV側釋壓裝置示意圖</h1>
						</div>
						<div id="tip1">
							<h1>型號:</h1>
							<h1>1: 3吋</h1>
							<h1>2: 4吋</h1>
							<h1>3: 6吋</h1>
							<h1>4: 8吋</h1>
							<h1>5: 10吋</h1>
						</div>
						<div id="tip2">
							<h1>種類:</h1>
							<h1>0: 平法蘭</h1>
							<h1>1: 溝法蘭</h1>
						</div>
						<div id="tip3">
							<h1>位置:</h1>
							<h1>1: 左</h1>
							<h1>2: 右</h1>
						</div>
						<div id="tip4">
							<img src="../pic/HVVACUUN.PNG" style="float:right;width:900px;height:400px;" alt="" />
							<h1 align="center">HV側抽真空管示意圖</h1>
						</div>
						<div id="tip5">
							<h1>端面至上蓋基準</h1>
						</div>
						<div id="tip6">
							<h1>套管插入上蓋深度 </h1>
						</div>
						<div id="tip7">
							<h1>型號:</h1>
							<h1>1: 1/2B</h1>
							<h1>2: 1B</h1>
							<h1>3: 3/2B</h1>
							<h1>4: 2B</h1>
							<h1>5: 3B</h1>
							<h1>6: 4B</h1>							
						</div>
						<div id="tip8">
							<img src="../pic/HV11.PNG" style="float:right;width:800px;height:400px;" alt="" />
							<h1 align="center">HV側法蘭示意圖</h1>
						</div>
						<div id="tip9">
							<h1>公稱直徑:</h1>
							<h1>1: 400</h1>
							<h1>2: 500</h1>
							<h1>3: 600</h1>
						</div>
						<div id="tip10">
							<h1>圓心至TR中心</h1>
						</div>		
						<div id="tip11">
							<h1>法蘭之間間距</h1>
						</div>
						<div id="tip12">
							<h1>1: 上內</h1>
							<h1>2: 上外</h1>
							<h1>3: 下內</h1>
							<h1>4: 下外</h1>
							<h1>0: 全部關閉</h1>							
						</div>	
						<div id="tip13">
							<h1>上部法蘭上緣至下部法蘭下緣</h1>
						</div>
						<div id="tip14">
							<h1>BCT型式:</h1>
							<h1>1. 21T3B2765-水平</h1>
							<h1>2. 21T3B3383-水平</h1>
							<h1>3. 21SA30583(圓形)</h1>
							<h1>4. 21SA40680(圓形)</h1>
						</div>
						<div id="tip15">
							<h1>法蘭面至套管箱中心</h1>
						</div>		
						<div id="tip16">
							<img src="../pic/HVCASINGBOX.PNG" style="float:right;width:800px;height:400px;" alt="" />
							<h1 align="center">HV側法蘭套管箱示意圖</h1>
						</div>	
						<div id="tip17">
							<img src="../pic/BCTBOX.PNG" style="float:right;width:500px;height:600px;" alt="" />
							<h1 align="center">BCT型式示意圖</h1>
						</div>
						<div id="tip18">
							<img src="../pic/BA_HVBUSHING_CHECK.PNG" style="float:right;width:650px;height:600px;" alt="" />
							<h1 align="center">套管安全距離示意圖</h1>
						</div>							
				</div>	
				
				
				

	
	

	
	<UL type=disc>

<!--HV側法蘭-->
	<LI><A name="HV側法蘭"><B><I><font face="monospace font"  size="5.5" color="blue">HV側法蘭 </font></B></I></A>

		
		
		<p><table width="900" align="center" style="border:2px solid;" rules="all" >
			<thead>
				<tr>			
					<th style="width: 15%;background-color:#E6E6FA;"><font face="monospace font"  size="5.5">名稱</th>		
					<th style="width: 70%;background-color:#E6E6FA;" colspan="2"><font face="monospace font"  size="5.5">參數設計項目</th>
					<th  style="width: 15%; background-color:#E6E6FA;"><font face="monospace font"  size="5.5">歷史異常</th>
				</tr>
			</thead>
			
			<tbody align="center">
				<tr>
					<td style="background-color:#FFFACD;" >
					<font face="monospace font"  size="5.5" >HV側法蘭<br>
					<!--<img src="pic/q1.png" align="center" width="75" height="75" value="說明一"  onmouseover="tooltip.pop(this, '#tip8',{hideDelay:100,calloutPosition: 0.5})">-->
					<img src="../pic/q1.png" align="center" width="75" height="75" id="pic3" style="cursor:help">
					</font>
					</td>
					
					<td style="background-color:#FFFACD;" align="left" > <font face="monospace font"  size="5.5">
					<!--<p>  公稱直徑<input type="text" name="HV_FC_1" id="HV_FC_1" value="" size="5"/></p>-->
					<p>	<div class="HV_FC_D">套管箱直徑<select  name="HV_FC_D" id="HV_FC_D" style="height:30px;width:400px;font-size:20px" onchange ="HV_FC_select()">
					<option value='None'    style="font-size:20px">None</option>
					</select></div></p>
					<p>  法蘭種類<input type="text" name="HV_F_1_S" id="HV_F_1_S" value="" size="5"/></p>
					<p>  法蘭位置<input type="text" name="HV_FLANGE_1_XP" id="HV_FLANGE_1_XP" value="" size="5"/></p>
					<p>  法蘭距離X<input type="text" name="HV_FLANGE_1_DIS" id="HV_FLANGE_1_DIS" value="" size="5"/></p>
					<p>  HV套管間距<input type="text" name="HV_FLANGE_1_X" id="HV_FLANGE_1_X" value="" size="5"/></p>					
					<p>  法蘭距離Y<input type="text" name="HV_FLANGE_1_Y" id="HV_FLANGE_1_Y" value="" size="5"/></p>
					<p>  法蘭高度<input type="text" name="HV_FLANGE_1_H" id="HV_FLANGE_1_H" value="" size="5"/></p>					
					<!--<p>  插入深度<input type="text" name="HV_FLANGE_1_DEEP" id="HV_FLANGE_1_DEEP" value="" size="5"/></p>-->	
					</td>
					<td style="background-color:#FFFACD;width:28%;height:1px;" align="left" ><font face="monospace font"  size="5.5" >
					<div class ="FY3"><font face="monospace font"  size="4" ><B>套管安全距離確認:<img src="../img/warning.png" align="center" width="32" height="32" id="pic6" style="cursor:help"><br>選擇標準:</font>
					<select  name="BIL_STANDARD" id="BIL_STANDARD" style="height:30px;width:130px;font-size:20px" onchange ="Standard_Select(document.tankForm.BIL_STANDARD.selectedIndex)">
							<option value='None'    style="font-size:20px">None</option>
							<!--<option value='IEC標準'    style="font-size:20px">IEC標準</option>-->
							<!--<option value='ANSI標準'    style="font-size:20px">ANSI標準</option>-->
							<option value='華城標準'    style="font-size:20px">華城標準</option>								
					</select><br><br>
					<font face="monospace font"  size="4" >選擇BIL等級:</font>
					<!--<div class="ANSI_BIL"><select  name="ANSI_BIL" id="ANSI_BIL" style="height:30px;width:100px;font-size:20px" onchange ="">
							<option value=60    style="font-size:20px">60kV </option>
							<option value=75    style="font-size:20px">75kV </option>
							<option value=95    style="font-size:20px">95kV </option>
							<option value=125    style="font-size:20px">125kV</option>
							<option value=200    style="font-size:20px">200kV</option>
							<option value=250    style="font-size:20px">250kV</option>
							<option value=300    style="font-size:20px">300kV</option>
							<option value=450    style="font-size:20px">450kV</option>
							<option value=550    style="font-size:20px">550kV</option>
							<option value=650    style="font-size:20px">650kV</option>
							<option value=750    style="font-size:20px">750kV</option>
							<option value=825    style="font-size:20px">825kV</option>
							<option value=975    style="font-size:20px">975kV</option>							
					</select></div>
					-->
					<div class="IEC_BIL"><select  name="IEC_BIL" id="IEC_BIL" style="height:30px;width:100px;font-size:20px" onchange ="HVD_BIL_check(document.tankForm.IEC_BIL.selectedIndex)">
							<option value='None'    style="font-size:20px">None</option>
					</select></div>
					<br><br><font face="monospace font"  size="4" ><b>建議BCT外徑:</font><input type="text" name="BCT_D" id="BCT_D" value="" size="4"/>
					<!--<div class="check_btn1" id="check_btn1" style=""><a href="javascript: myFunction1(document.tankForm.ANSI_BIL.selectedIndex);"><img src="../img/check2.png" align="center" width="200" height="50" id="pic99" style="cursor:help"></a></div>-->
					<!--<div class="check_btn2" id="check_btn2" style=""><a><img src="../img/check2.png" align="center" width="200" height="50" id="pic99" style="cursor:help" onclick="myFunction(document.tankForm.IEC_BIL.selectedIndex);FE_BIL_check(document.tankForm.HV_FC_D.selectedIndex);"></a></div>-->
					<!--關閉ANSI/IEC標準 只用華城標準-->
					<div class="check_btn2" id="check_btn2" style=""><a><img src="../img/check2.png" align="center" width="200" height="50" id="pic99" style="cursor:help" onclick="FE_BIL_check(document.tankForm.HV_FC_D.selectedIndex);"></a></div>
					</div>
					</td>	

					<td style="background-color:#FFFACD;" align="left" ><font face="monospace font"  size="5.5" >
					<!--<div class="myBtn" id="myBtn6" style="cursor:pointer;"><strong >HV側法蘭異常</strong></div>-->				
					</td>
					<div class="HV_FC"><input type="text" name="HV_FC_1" id="HV_FC_1" value="" size="5"/></div>
				</tr>
				


		


				
				<tr>
					<td style="background-color:#FFFACD;">
					<font face="monospace font"  size="5.5">HV側法蘭套管箱<br>
					<!--<img src="pic/q1.png" align="center" width="75" height="75" value="說明一"  onmouseover="tooltip.pop(this, '#tip8',{hideDelay:100,calloutPosition: 0.5})">-->
					<img src="../pic/q1.png" align="center" width="75" height="75" id="pic4" style="cursor:help;">
					</font>
					</td>
					
					<td style="background-color:#FFFACD;" align="left" colspan="2"> <font face="monospace font"  size="5.5">
					<!--<p>  套管箱開關<input type="text" name="HV_CAS_SW" id="HV_CAS_SW" value="" size="5"/></p>-->
					<p>  套管箱開關<select  name="HV_CAS_SW" id="HV_CAS_SW" style="height:30px;width:50px;font-size:20px;" onchange ="">
					<option value='None' style="font-size:20px">None</option>           
					<option value='1'    style="font-size:20px">1</option>
					<option value='2'    style="font-size:20px">2</option>
					<option value='3'    style="font-size:20px">3</option>	
					<option value='4'    style="font-size:20px">4</option>	
					<option value='5'    style="font-size:20px">5</option>						
					</select></p>
					<p>  套管箱高度<input type="text" name="HV_CAS_H" id="HV_CAS_H" value="" size="5"/></p>
					<p>  BCT型式<input type="text" name="HV_CAS_B" id="HV_CAS_B" value="" size="5"/><img src="../img/icon2.png" align="center" width="32" height="32" id="pic5" style="cursor:help"></p>
					<p>  BCT高度<input type="text" name="HV_CAS_BH" id="HV_CAS_BH" value="" size="5"/></p>
					<p>  BCT深度<input type="text" name="HV_CAS_BD" id="HV_CAS_BD" value="" size="5"/></p>	
					<p>  油氣管位置<input type="text" name="" id="" value="" size="5"/></p>
					<p>  油氣管伸出距離<input type="text" name="" id="" value="" size="5"/></p>					
					</td>
					<td style="background-color:#FFFACD;" align="left"><font face="monospace font"  size="5.5" >
					<!--<div class="myBtn" id="myBtn67" style="cursor:pointer;"><strong >HV側法蘭套管箱異常</strong></div>-->
					</td>
				</tr>

			</tbody>			
		</table></p>	
<!--		
 
<input type="text" name="data" id="data" value="" size="5"/></p>
<iframe name="I1" height="0" width="0" style="display:none"></iframe> 

-->
 <textarea name="data" id="data"  rows="6" cols="40"  maxlength="40" readonly placeholder="防呆輸入錯誤紀錄" style="font-size:20px;"></textarea>
 <input type="button" class="ex_btn" value="匯出錯誤紀錄" onclick="openPdf()">
<script> 
function export2csv() { 
// 取得表單名稱為form1的表單集合
	var oform = document.forms["tankForm"];  //需與網頁form name相同
 
	
	var ret;
	var FunctionName;
	var FeatureID;
	I1.document.body.innerHTML = ""; 
	//Parameter Type: PWL_MODEL, PWL_FEATURE
	var ItemType = document.pwl.eval("PWL_MODEL");
	if (parseInt(ItemType) === parseInt(document.pwlc.PWL_MODEL)) {
		FeatureID = -1;
		ret = document.pwl.pwlMdlParametersGet(layoutModelNameExt);
		FunctionName = "pwlMdlParametersGet";
	}
	if (!ret.Status) {
		alert(FunctionName + " failed (" + ret.ErrorCode + ")");
		return;
	}
	
	for (var i = 0; i < ret.NumParams; i++) {
		var objParameterName = ret.ParamNames.Item(i);

		
		/*
		//以元素ID存取值-過濾單一網頁不存在之參數項目
		var obj = oform.elements[objParameterName];
		//alert(objParameterName);
		if(typeof obj == 'undefined' || obj == null){
			//若input物件不存在, 直接到下一個迴圈, 處理下一個變數
			continue;
		}
		*/

		
		var val_ret = document.pwl.pwlParameterValueGet(layoutModelNameExt, parseInt(ItemType),
				FeatureID, objParameterName); //切換objParameterName 可擷取其他頁面參數值
		/*
		if (!val_ret.Status) {
			alert("pwlParameterValueGet failed (" + val_ret.ErrorCode + ")" + objParameterName);
			return;
		}
		*/
		var answer = "Undefined";
		if (val_ret.ParamType == parseInt(document.pwlc.PWL_VALUE_DOUBLE)) {
			answer = val_ret.ParamDoubleVal;
		} else if (val_ret.ParamType == parseInt(document.pwlc.PWL_VALUE_STRING)) {
			answer = val_ret.ParamStringVal;
		} else if (val_ret.ParamType == parseInt(document.pwlc.PWL_VALUE_INTEGER)) {
			answer = val_ret.ParamIntVal;
		} else if (val_ret.ParamType == parseInt(document.pwlc.PWL_VALUE_BOOLEAN)) {
			answer = (val_ret.ParamBooleanVal) ? "true" : "false";
		}
		
		var objParameterValue = answer;		
		
		
		I1.document.write(objParameterName+'\t'); 
		I1.document.writeln(answer);

	}	

	I1.document.execCommand('SaveAs',true, '*.xls');



} 


</script>	
		
	</form>
	
	<script type="text/javascript">
	//取得資料
	TRParametersSet();
	load_HV_CAS_SW();
	</script>
</body>


</HTML>